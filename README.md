
# Multilevel Thresholding for Image Segmentation
This project implements multilevel thresholding for image segmentation using two algorithms: Simulated Annealing (SA) and Variable Neighbourhood Search (VNS). The objective functions used for segmentation are Otsu's method and Kapur's method. This project processes multiple images and compares the effectiveness of these two algorithms for different threshold levels (k=2,3,4,5).

## Requirements
Python: Latest version (tested on Python 3.8+)
Libraries:
numpy: for numerical operations
cv2 (OpenCV): for image processing
matplotlib: for plotting histograms and segmented images
random: for random threshold tweaks in SA and VNS algorithms
##Setup Instructions
1. Clone or download this repository.
2. Make sure you have Anaconda and Visual Studio Code installed (if you're using that setup).
3. Open the project folder in Visual Studio Code.
3. Create a new environment using Anaconda (if needed):
   ``bash
conda create -n image_segmentation_env python=3.8
conda activate image_segmentation_env``    
Install the required libraries:
 ``bash
conda install numpy opencv matplotlib```
## Usage
The project allows you to perform image segmentation on multiple images using both SA and VNS algorithms. Each image is segmented based on different threshold levels (k=2,3,4,5), and the results are saved as images with corresponding segmented thresholds.

## Running the Code
Place all the images you want to process in a folder, for example, Code/Ass2/.
Run the following script to apply the segmentation to all images in that folder:
``bash 
python main.py
This will:

-Apply Simulated Annealing and Variable Neighbourhood Search for both Otsu's method and Kapur's method.
-Segment the images based on threshold levels (k=2,3,4,5).
-Save the segmented images to the output folder Code/output_images.
Example Command
``bash
folder_path = 'Code/Ass2'
go_all_folder(folder_path)``
Example Output
For each image, the following segmented images will be saved:

-Simulated Annealing (Otsu): *_sa_otsu.png
-Variable Neighbourhood Search (Otsu): *_vns_otsu.png
-Simulated Annealing (Kapur): *_sa_kapur.png
-Variable Neighbourhood Search (Kapur): *_vns_kapur.png
-These images will be saved in the Code/output_images/ folder.

## Random Seed for Reproducibility
A random seed (ran_seed=42) is set throughout the project to ensure reproducibility. The same seed value is used in:

Simulated Annealing: to ensure reproducible random threshold adjustments.
Variable Neighbourhood Search: to ensure reproducible local and global neighborhood searches.
If you want to change the seed, you can modify the seed value in the go_all_folder() or individual_image() functions.

## Functions Overview
1. Simulated Annealing (simulated_annealing): Optimizes the thresholds by tweaking them and accepting worse solutions with some probability.
2. Variable Neighbourhood Search (variable_neighbourhood_search): Explores local and global changes to thresholds to find the best segmentation.
3. Threshold Application (apply_thresholds): Segments the image based on the calculated thresholds.
3. Histogram Creation (create_histogram): Creates histograms of pixel intensities to visualize the segmentation.
4. Image Visualization (show_segmented_images): Displays the original image, the segmented images, and the histograms.
## Files
main.py: Main script that runs the segmentation on all images in the specified folder.
Code/Ass2/: Folder containing the input images.
Code/output_images/: Folder where the segmented images will be saved

## Project Structure
``
|-- Code/
    |-- Ass2/                # Input images
    |-- output_images/        # Segmented images saved here
|-- main.py                  # Main script to run the project
|-- README.md                # Project documentation (this file)``
## Results
Each image will be segmented into multiple levels based on different threshold values. The segmented images and histograms will be saved for both Otsu's method and Kapur's method, with segmentation generated by both SA and VNS.

## License
This project is provided under the MIT License.
